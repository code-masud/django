{% extends "base.html" %}

{% block title %}
    {{ title }}
{% endblock title %}

{% block content %}
<h4><small>SEARCH RESULTS FOR "{{ query }}"</small></h4>
<hr>
{% for post in post_list %}
<h2><a href="{% url "blog:post-detail" category_slug=post.category.slug post_slug=post.slug %}">{{ post.title|truncatechars:50 }}</a></h2>
<h5>Post by {{ post.author.username }}, {{ post.created_at|date:"M d, Y"}}.</h5>
<h5><span class="label label-danger"><a href="{% url "blog:category-detail" post.category.slug %}">{{ post.category.name }}</a></span></h5><br>
<p>{{ post.content|truncatechars:350 }}</p>
<br>
{% empty %}
<h4><small>NO RESULT FOUND</small></h4>
{% endfor %}

{% if is_paginated %}
<nav aria-label="Page navigation">
    <ul class="pagination justify-content-center">
        {% if page_obj.has_previous %}
            <li class="page-item"><a class="page-link" href="?q={{query}}&page={{page_obj.previous_page_number}}">Previous</a></li>
        {% endif %}
        {% for num in paginator.page_range %}
            {% if page_obj.number == num %}
                <li class='page-item active'><span class="page-link">{{ num }}</span></li>
            {% elif num > page_obj.number|add:'-2' and num < page_obj.number|add:'2' %}
            <li class="page-item"><a class="page-link" href="?q={{query}}&page={{num}}">{{ num }}</a></li>
            {% endif %}
        {% endfor %}
        {% if page_obj.has_next %}
            <li class="page-item"><a class="page-link" href="?q={{query}}&page={{page_obj.next_page_number}}">Next</a></li>
        {% endif %}
    </ul>
</nav>
{% endif %}

{% endblock content %}
